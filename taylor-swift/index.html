<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Eras Tour on Data</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }
        
        /* 新增全页面滚动容器 */
        .scroll-wrapper {
            height: 100vh;
            overflow-y: scroll;
            scroll-snap-type: y mandatory;
        }
        
        /* 修改所有screen类为滚动吸附点 */
        .cover-container,
        .screen-intro,
        .screen-albums,
        .screen-overview,
        .screen-streams,
        .album-cover-page,
        .album-info-page,
        .wordcloud-page,
        .topsongs-page {
            height: 100vh;
            width: 100vw;
            scroll-snap-align: start;
        }

        /* 全屏封面容器 - 默认显示横版图 */
        .cover-container {
            height: 100vh;
            width: 100vw;
            background: 
                linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.5)),
                url('https://www.taylorswift.com/wp-content/uploads/sites/2529/2024/12/img-fearless-compressed.jpg') center/cover no-repeat;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            padding: 20px;
            box-sizing: border-box;
        }
        
        /* 移动端竖版图 */
        @media (max-width: 768px) and (orientation: portrait) {
            .cover-container {
                background: 
                    linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.5)),
                    url('https://assets.dmi.umgapps.com/assets/taylor-swift/landing-images/1678544276252-2-v2.jpg') center/cover no-repeat;
            }
        }
        
        /* 标题样式 */
        .cover-title {
            max-width: 800px;
        }
        
        .cover-title h1 {
            font-size: clamp(2.5rem, 6vw, 4.5rem);
            font-weight: 800;
            margin-bottom: 1rem;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        
        .cover-title p {
            font-size: clamp(1.2rem, 2.5vw, 1.8rem);
            opacity: 0.9;
            font-weight: 300;
            text-shadow: 0 1px 5px rgba(0,0,0,0.3);
        }
        
        /* 滚动提示 */
        .scroll-hint {
            position: absolute;
            bottom: 30px;
            animation: bounce 2s infinite;
        }

        /* 当页面滚动到第二页时 */
        body.scrolled .scroll-hint {
        color: black;
        text-shadow: 0 1px 3px rgba(255,255,255,0.3);
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-20px);}
            60% {transform: translateY(-10px);}
        }

    </style>
    <style>@import url("css/page2.css");</style>
    <style>@import url("css/page3.css");</style>
    <style>@import url("css/page4.css");</style>
    <style>@import url("css/page5.css");</style>
    <style>@import url("css/album.css");</style>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <div class="scroll-wrapper">
    <div class="cover-container">
        <div class="cover-title">
            <h1>The Eras Tour on Data</h1>
            <p>用数据穿越 Taylor Swift 的音乐纪元</p>
            <p>数据可视化导论作业 曹彧 2300013198</p>
        </div>
        <div class="scroll-hint">
            ↓ 向下滚动 ↓
        </div>
    </div>

    <section class="screen-intro">
        <div class="intro-container">
            <div class="intro-content">
                <h2>Introduction</h2>
                <p class="full-text">泰勒·斯威夫特 (Taylor Swift) 是21世纪最具影响力的音乐人之一，拥有11张录音室专辑，全球销量超过2亿张。她的音乐跨越乡村、流行、民谣等多种风格，获得12座格莱美奖，创下多项音乐行业纪录。</p>
                <p class="full-text">2025年5月，Taylor Swift 以3.6亿美元的价格成功回购了她前六张专辑的母带版权，结束了与 Big Machine 公司长达六年的版权斗争。这一举动标志着她重新获得了对自己全部音乐作品的控制权，成为艺术家自主权的里程碑事件。</p>
                <p class="full-text">她的"Eras Tour"巡演成为史上最成功的商业巡演，总收入超过20.77亿美元，远超此前纪录保持者。最新专辑《The Tortured Poets Department》（苦难诗社）于2024年发行后继续打破多项销售纪录。</p>
                <p class="full-text">下面，让我们一起来走进这场 Eras Tour on Data，探索 Taylor Swift 从乡村音乐少女到流行天后的蜕变历程，用数据揭示她音乐宇宙中的创作密码与时代印记。</p>
                <p class="short-text">Taylor Swift 是21世纪最具影响力的音乐人之一，拥有11张录音室专辑，全球销量超过2亿张。她的音乐跨越乡村、流行、民谣等多种风格，获得12座格莱美奖，创下多项音乐行业纪录。</p>
                <p class="short-text">下面，让我们一起来走进这场 Eras Tour on Data，探索 Taylor Swift 从乡村音乐少女到流行天后的蜕变历程，用数据揭示她音乐宇宙中的创作密码与时代印记。</p>
            </div>
            <div class="intro-image">
                <!-- 替换为你的图片路径 -->
                <img src="https://www.taylorswift.com/wp-content/uploads/sites/2529/2025/06/tletter1-768x768.png" alt="Taylor Swift">
            </div>
        </div>
    </section>

    <section class="screen-albums">
        <div class="albums-title">
            <h2>The Eras Collection</h2>
            <p>点击专辑标志查看封面。注：TV 代表 Taylor's Version。为了夺回原始专辑的版权，Taylor 选择重录旧作。</p>
        </div>
        
        <div class="albums-grid">
            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-Taylor-Swift.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">Taylor Swift</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-Taylor-Swift.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>

            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-Fearless.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">Fearless</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-Fearless.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>

            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-Speak-Now.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">Speak Now</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-Speak-Now.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>

            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-Red.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">Red</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-Red.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>

            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-1989.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">1989</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-1989.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>

            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-Reputation.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">Reputation</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-Reputation.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>

            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-Lover.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">Lover</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-Lover.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>

            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-Folklore.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">Folklore</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-Folklore.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>

            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-Evermore.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">Evermore</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-Evermore.png" 
                            alt="Taylor Swift"
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>


            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-Fearless-TV.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">Fearless (TV)</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-Fearless-TV.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>

            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-Red-TV.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">Red (TV)</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-Red-TV.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>

            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-Midnights.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">Midnights</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-Midnights.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>

            
            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-Speak-Now-TV.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">Speak Now (TV)</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-Speak-Now-TV.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>


            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-1989-TV.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">1989 (TV)</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-1989-TV.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>


            <div class="album-card" data-album="taylor-swift">
                <div class="album-card-inner">
                    <div class="album-card-front">
                        <img src="img/logo-TTPD.png" 
                            alt="Taylor Swift" 
                            class="album-logo">
                        <p class="album-name">TTPD</p>
                    </div>
                    <div class="album-card-back">
                        <img src="img/img-TTPD.png" 
                            alt="Taylor Swift" 
                            class="album-cover"
                            note="">
                    </div>
                </div>
            </div>

            <!-- 复制上面的div，替换为其他14个专辑 -->
        </div>
    </section>

    <section class="screen-overview">
        <div class="overview-title">
            <h2>Number of Songs</h2>
            <p>专辑歌曲数量分布。共收录了Taylor Swift 11张专辑的230首歌曲（将Taylor's Version和原曲合并）。2024年 TTPD专辑包含的曲目数量最多。</p>
        </div>
        
        <div class="visualization-container">
            <div id="pie-chart" class="chart"></div>
            <div id="bar-chart" class="chart">
                <p>共计 230 首歌曲，其中 TTPD 专辑歌曲数目最多（包含黑胶专辑）</p>
            </div>
        </div>
    </section>

    <section class="screen-streams" id="streams-chart-section">
    <div class="chart-container">
        <h2>Streams of Albums</h2>
        <div class="chart-wrapper">
        <svg id="streams-chart"></svg>
        </div>
        <p class="chart-note">数据来源：Spotify (2025年4月11日统计)，将Taylor's Version与原版合并。鼠标悬停查看详细信息。</p>
        <div class="chart-analysis">
        <h3>数据解读</h3>
        <ul>
            <li><strong>1989</strong>：转型流行音乐后的巅峰之作，原版和重录版播放总量达141.77亿次</li>
            <li><strong>Lover</strong>：无重录，单张专辑播放总量最高</li>
            <li><strong>Midnights</strong>：疫情后另类风格获得艺术突破</li>
        </ul>
        </div>
    </div>
    
    </section>

    <!-- Taylor Swift 同名专辑部分 -->
    <section class="album-section" id="taylor-swift-album">
        <!-- 第一页：专辑封面背景 + 标题 -->
        <section class="album-cover-page">
            <div class="album-cover-background" 
                style="background: linear-gradient(rgba(0,0,0,0.2), rgba(0,0,0,0.5)), 
                        url('img/img-Taylor-Swift.png') center/cover no-repeat;">
                <div class="album-title-container">
                    <h2 class="album-title">Taylor Swift</h2>
                    <p class="album-subtitle">乡村音乐的纯真起点 · 2006年出道专辑</p>
                    <p class="album-brief">16岁的天才少女用吉他谱写的青春诗篇</p>
                </div>
            </div>
        </section>

        <section class="album-info-page" style="background: linear-gradient(135deg, #1D4737, #81A757)">
            <div class="album-info-container">
                <div class="album-info-image">
                    <img src="https://upload.wikimedia.org/wikipedia/en/1/1f/Taylor_Swift_-_Taylor_Swift.png" 
                        alt="Taylor Swift Album Cover">
                </div>
                <div class="album-info-text">
                    <h3>专辑介绍</h3>
                    <p>《Taylor Swift》是泰勒·斯威夫特（Taylor Swift）的首张录音室专辑，由内森·查普曼和罗伯特·埃利斯·奥拉尔制作，标准版收录了11首歌曲，加曲版收录15首歌曲，于2006年10月24日由大机器唱片公司发行。</p>
                    <p>2007年，《Taylor Swift》在公告牌乡村乐专辑榜年终夺下季军，在公告牌二百强专辑榜排名第19；2008年，专辑凭借约204万的销量在公告牌二百强专辑榜排名第5；2008年，收录曲《Our Song》获得乡村音乐电视奖"年度女歌手歌曲MV"和"年度歌曲MV"奖项。</p>
                </div>
            </div>
        </section>

        <!-- 第三页：词云图 -->
        <section class="wordcloud-page" style="background: linear-gradient(135deg, #1D4737, #81A757)">
            <div class="wordcloud-container">
                <h3 style="color:#E7DBCC">歌词词云</h3>
                <p style="color:#E7DBCC">本专辑高频词汇可视化</p>
                
                <div class="wordcloud-image-container">
                    <!-- 替换为你的词云图路径 -->
                    <img src="wordclouds/TSW_wordcloud.png" alt="Taylor Swift专辑词云" class="wordcloud-image">
                </div>
                
                <div class="wordcloud-notes">
                    <p style="color: #E7DBCC">早期乡村音乐中，"know"、"back"、"think"等词汇高频出现，这些词能强化故事讲述、情感直白，更依赖认知动词直接表达内心活动。</p>
                </div>
            </div>
        </section>

        <section class="topsongs-page">
            <div class="topsongs-container">
                <h3>专辑 Top 6 歌曲播放量</h3>
                <p>本专辑最受欢迎的歌曲排行 (数据来源: Spotify 2024.12.11)</p>
                
                <div class="chart-container-2">
                    <svg id="tsw-chart" width="100%" height="400"></svg>
                </div>
                
                <div class="chart-notes">
                    <p>《Our Song》作为本专辑冠军单曲，播放量高达3.8亿次，展现了Taylor早期乡村风格的感染力</p>
                </div>
            </div>
        </section>

    </section>

    <!-- Fearless 部分 -->
    <section class="album-section" id="Fearless-album">
        <!-- 第一页：专辑封面背景 + 标题 -->
        <section class="album-cover-page">
            <div class="album-cover-background" 
                style="background: linear-gradient(rgba(0,0,0,0.2), rgba(0,0,0,0.5)), 
                        url('img/img-Fearless.png') center/cover no-repeat;">
                <div class="album-title-container">
                    <h2 class="album-title">Fearless</h2>
                    <p class="album-subtitle">闪耀的乡村流行跨界 · 2008年格莱美年度专辑</p>
                    <p class="album-brief">金色流苏下的青春宣言，奠定全球巨星地位的突破之作</p>
                </div>
            </div>
        </section>

        <section class="album-info-page" style="background: linear-gradient(135deg, #6E4823, #CBA863)">
            <div class="album-info-container">
                <div class="album-info-image">
                    <img src="https://upload.wikimedia.org/wikipedia/en/8/86/Taylor_Swift_-_Fearless.png?20230827021325" 
                        alt="Taylor Swift Album Cover">
                </div>
                <div class="album-info-text">
                    <h3 style="color:#976F34; border-bottom: 2px solid #6E4823">专辑介绍</h3>
                    <p>《Fearless》是泰勒·斯威夫特的第二张录音室专辑，于2008年11月11日发行。专辑融合乡村与流行元素，诞生了《Love Story》《You Belong with Me》等现象级单曲。它成为21世纪美国最畅销的乡村专辑，并获得第52届格莱美年度专辑奖。</p>
                    <p>2021年4月9日，泰勒发布重录版《Fearless (Taylor's Version)》，新增6首"From The Vault"未发行曲目。原版专辑已获RIAA钻石认证（1000万张），重录版首周销量达29.1万张，创下乡村专辑最高首周纪录。</p>
                    <p>专辑名称源自泰勒对音乐创作的信念："真正的恐惧不是失败，而是放弃尝试"。</p>
                </div>
            </div>
        </section>

        <!-- 第三页：词云图 -->
        <section class="wordcloud-page" style="background: linear-gradient(135deg, #6E4823, #CBA863)">
            <div class="wordcloud-container">
                <h3 style="color:#E1D4C2">歌词词云</h3>
                <p style="color:#E1D4C2">本专辑高频词汇可视化</p>
                
                <div class="wordcloud-image-container">
                    <!-- 替换为你的词云图路径 -->
                    <img src="wordclouds/FER_wordcloud.png" alt="Fearless专辑词云" class="wordcloud-image">
                </div>
                
                <div class="wordcloud-notes">
                    <p style="color: #E7DBCC">come，know等词高频出现反应了专辑的叙事特质：如，I keep waiting for you, but you never come (Love Story); 
                        And I don't know how it gets better than this (Fearless)</p>
                </div>
            </div>
        </section>

        <section class="topsongs-page" style="background: linear-gradient(135deg, #6E4823, #CBA863)">
            <div class="topsongs-container">
                <h3 style="color: #6E4823">专辑 Top 6 歌曲播放量</h3>
                <p>本专辑最受欢迎的歌曲排行 (数据来源: Spotify 2024.12.11)</p>
                
                <div class="chart-container-2">
                    <svg id="fer-chart" width="100%" height="400"></svg>
                </div>
                
                <div class="chart-notes">
                    <p>《Love Story》和《You Belong With Me》以累计超33亿次的惊人播放量，成为Fearless专辑现象级的双冠王，完美诠释了泰勒乡村流行跨界音乐的全球影响力，几乎家喻户晓。</p>
                </div>
            </div>
        </section>

    </section>

    <!-- Speak Now 部分 -->
    <section class="album-section" id="Speak-now-album">
        <!-- 第一页：专辑封面背景 + 标题 -->
        <section class="album-cover-page">
            <div class="album-cover-background" 
                style="background: linear-gradient(rgba(0,0,0,0.2), rgba(0,0,0,0.5)), 
                        url('img/img-Speak-Now.png') center/cover no-repeat;">
                <div class="album-title-container">
                    <h2 class="album-title">Speak Now</h2>
                    <p class="album-subtitle">全创作个人宣言 · 首周销量104万拿到冠砖</p>
                    <p class="album-brief">紫色梦境中的成长独白，首张100%独立创作的音乐日记</p>
                </div>
            </div>
        </section>

        <section class="album-info-page" style="background: linear-gradient(135deg, #2A122C, #72325F)">
            <div class="album-info-container">
                <div class="album-info-image">
                    <img src="https://upload.wikimedia.org/wikipedia/en/5/5b/Taylor_Swift_-_Speak_Now_%28Taylor%27s_Version%29.png?20230506105004" 
                        alt="Taylor Swift Album Cover">
                </div>
                <div class="album-info-text">
                    <h3 style="color:#2A122C; border-bottom: 2px solid #72325F">专辑介绍</h3>
                    <p>《Fearless》是泰勒·斯威夫特的第二张录音室专辑，于2008年11月11日发行。专辑融合乡村与流行元素，诞生了《Love Story》《You Belong with Me》等现象级单曲。它成为21世纪美国最畅销的乡村专辑，并获得第52届格莱美年度专辑奖。</p>
                    <p>2021年4月9日，泰勒发布重录版《Fearless (Taylor's Version)》，新增6首"From The Vault"未发行曲目。原版专辑已获RIAA钻石认证（1000万张），重录版首周销量达29.1万张，创下乡村专辑最高首周纪录。</p>
                    <p>专辑名称源自泰勒对音乐创作的信念："真正的恐惧不是失败，而是放弃尝试"。</p>
                </div>
            </div>
        </section>

        <!-- 第三页：词云图 -->
        <section class="wordcloud-page" style="background: linear-gradient(135deg, #6E4823, #CBA863)">
            <div class="wordcloud-container">
                <h3 style="color:#E1D4C2">歌词词云</h3>
                <p style="color:#E1D4C2">本专辑高频词汇可视化</p>
                
                <div class="wordcloud-image-container">
                    <!-- 替换为你的词云图路径 -->
                    <img src="wordclouds/FER_wordcloud.png" alt="Fearless专辑词云" class="wordcloud-image">
                </div>
                
                <div class="wordcloud-notes">
                    <p style="color: #E7DBCC">come，know等词高频出现反应了专辑的叙事特质：如，I keep waiting for you, but you never come (Love Story); 
                        And I don't know how it gets better than this (Fearless)</p>
                </div>
            </div>
        </section>

        <section class="topsongs-page" style="background: linear-gradient(135deg, #6E4823, #CBA863)">
            <div class="topsongs-container">
                <h3 style="color: #6E4823">专辑 Top 6 歌曲播放量</h3>
                <p>本专辑最受欢迎的歌曲排行 (数据来源: Spotify 2024.12.11)</p>
                
                <div class="chart-container-2">
                    <svg id="spn-chart" width="100%" height="400"></svg>
                </div>
                
                <div class="chart-notes">
                    <p>《Love Story》和《You Belong With Me》以累计超33亿次的惊人播放量，成为Fearless专辑现象级的双冠王，完美诠释了泰勒乡村流行跨界音乐的全球影响力，几乎家喻户晓。</p>
                </div>
            </div>
        </section>

    </section>

    </div>

    <script>
        
    const tooltip = d3.select("body").append("div")
        .attr("class", "tooltip")
        .style("position", "absolute")
        .style("visibility", "hidden")
        .style("padding", "8px")
        .style("background", "rgba(0,0,0,0.8)")
        .style("color", "white")
        .style("border-radius", "4px")
        .style("pointer-events", "none")
        .style("font-size", "14px")
        .style("z-index", "10");
    
    // 添加IntersectionObserver监听
    const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        const scrollHint = document.querySelector('.scroll-hint');
        if (entry.isIntersecting && (entry.target.classList.contains('screen-intro')||entry.target.classList.contains('screen-albums')
    ||entry.target.classList.contains('screen-overview'))) {
        scrollHint.style.color = 'black';
        } else {
        scrollHint.style.color = 'white';
        }
    });
    }, { threshold: 0.5 });

    // 监听第二页
    observer.observe(document.querySelector('.screen-intro'));
    observer.observe(document.querySelector('.screen-albums'));
    observer.observe(document.querySelector('.screen-overview'));
    </script>

    <script>
        // 专辑翻牌效果
        document.querySelectorAll('.album-card').forEach(card => {
            card.addEventListener('click', function() {
                this.classList.toggle('flipped');
            });
        });
    </script>


    <script>
        // 在现有script后添加
const albumColors = {
    "Taylor Swift": "#1D4737", // 首专红
    "Fearless": "#CBA863",    // 金色
    "Speak Now": "#833C63",   // 紫色
    "Red": "#A91E47",         // 正红
    "1989": "#846578",        // 道奇蓝
    "Reputation": "#2C2C2C",  // 黑色
    "Lover": "#EBBED3",       // 浅粉
    "Folklore": "#949494",    // 灰色
    "Evermore": "#421E18",    // 马鞍棕
    "Fearless (TV)": "#624324", // 同Fearless
    "Red (TV)": "#731803",      // 同Red
    "Midnights": "#5A658B",    // 午夜蓝
    "Speak Now (TV)": "#4a2454", // 同Speak Now
    "1989 (TV)": "#8BB5D2",     // 同1989
    "TTPD": "#1C160F"          // 勃艮第红
};



document.addEventListener('DOMContentLoaded', function() {
    // 加载数据
    d3.tsv("https://calvinxiaocao.github.io/taylor-swift/data/cots-album-details.tsv").then(function(data) {
            data.forEach(d => {
            if(d.Title === "The Tortured Poets Department") {
                d.Title = "TTPD";
            }
        });
        // 过滤掉"Other Songs"
        const albumData = data.filter(d => d.Title !== "Other Songs");
        const originData = data.filter(d => d.Title !== "Other Songs");
        
        // 转换数据类型
        albumData.forEach(d => {
            d.Songs = +d.Songs;
            d.Lines = +d.Lines;
            d.Words = +d.Words;
        });
        
        // 按歌曲数量排序
        albumData.sort((a, b) => b.Songs - a.Songs);
        
        // 创建饼图
        createPieChart(albumData);
        
        // 创建柱状图
        createBarChart(albumData);

        drawStreamsChart(originData);
    });
});

function createPieChart(data) {
    const width = window.innerWidth < 768 ? 200 : 400;
    const height = window.innerWidth < 768 ? 250 : 400;
    const radius = Math.min(width, height) / 2;
    
    const svg = d3.select("#pie-chart")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .append("g")
        .attr("transform", `translate(${width/2},${height/2})`);
    

    const color = d3.scaleOrdinal()
    .domain(data.map(d => d.Title))
    .range(data.map(d => albumColors[d.Title] || "#999999"));
    
    // 饼图生成器
    const pie = d3.pie()
        .value(d => d.Songs)
        .sort(null);
    
    // 弧生成器
    const arc = d3.arc()
        .innerRadius(0)
        .outerRadius(radius);
    
    // 创建弧
    const arcs = svg.selectAll("arc")
        .data(pie(data))
        .enter()
        .append("g")
        .attr("class", "arc");
    
    // 添加路径
    arcs.append("path")
        .attr("d", arc)
        .attr("fill", d => color(d.data.Title))
        .attr("stroke", "white")
        .attr("stroke-width", 2)
        // .attrTween("d", function(d) {
        //     const interpolate = d3.interpolate({startAngle: 0, endAngle: 0}, d);
        //     return function(t) {
        //         return arc(interpolate(t));
        //     };
        // })
        .on("mouseover", function(event, d) {
            d3.select(this)
                .attr("stroke-width", 4)
                .attr("stroke", "#333");
            
            tooltip.html(`${d.data.Title}<br>${d.data.Songs}首`)
                .style("visibility", "visible");
        })
        .on("mousemove", function(event) {
            tooltip.style("top", `${event.pageY - 10}px`)
                .style("left", `${event.pageX + 10}px`);
        })
        .on("mouseout", function() {
            d3.select(this)
                .attr("stroke-width", 2)
                .attr("stroke", "white");
            
            tooltip.style("visibility", "hidden");
        });
        
    
    // 添加标签
    arcs.append("text")
        .attr("transform", d => `translate(${arc.centroid(d)})`)
        .attr("dy", "0.35em")
        .text(d => d.data.Songs)
        .style("text-anchor", "middle")
        .style("font-size", "12px")
        .style("font-weight", "bold")
        .style("fill", "white");
    
    // 添加图例
    const legend = d3.select("#pie-chart")
    .append("div")
    .attr("class", "legend")
    .style("display", "grid")
    .style("grid-template-columns", "repeat(3, 1fr)") // 改为3列
    .style("gap", "6px") // 缩小间隙
    // .style("margin-top", "20px")
    .style("position", "absolute") // 新增
    .style("bottom", "20px") // 新增 - 放到底部
    .style("left", "0") // 新增
    .style("right", "0") // 新增
    .style("padding", "0 20px"); // 新增 - 左右留白
    
    const legendItems = legend.selectAll(".legend-item")
        .data(data)
        .enter()
        .append("div")
        .attr("class", "legend-item")
        .style("display", "flex")
        .style("align-items", "center")
        .style("font-size", "12px");
    
    legendItems.append("div")
        .style("width", "12px")
        .style("height", "12px")
        .style("background-color", d => color(d.Title))
        .style("margin-right", "5px");
    
    legendItems.append("div")
        .text(d => `${d.Title} (${d.Songs})`);
}

function createBarChart(data) {
    let margin = {top: 20, right: 30, bottom: 40, left: 90};
    let width = 500 - margin.left - margin.right;
    let height = 400 - margin.top - margin.bottom;

    if (window.innerWidth < 768) {
        width = width / 2;
        height = height / 2;
        margin = {top: 8, right: 8, bottom: 8, left: 90};
    }
    
    const svg = d3.select("#bar-chart")
        .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);
    
    // 颜色比例尺
    const color = d3.scaleOrdinal()
    .domain(data.map(d => d.Title))
    .range(data.map(d => albumColors[d.Title] || "#999999"));
    
    // X轴比例尺
    const x = d3.scaleLinear()
        .domain([0, d3.max(data, d => d.Songs)])
        .range([0, width]);
    
    // Y轴比例尺
    const y = d3.scaleBand()
        .domain(data.map(d => d.Title))
        .range([0, height])
        .padding(0.2);
    
    // 添加条形
    svg.selectAll("rect")
        .data(data)
        .enter()
        .append("rect")
        .attr("y", d => y(d.Title))
        .attr("width", 0)
        .attr("height", y.bandwidth())
        .attr("fill", d => color(d.Title))
        // .transition()
        // .duration(1000)
        .attr("width", d => x(d.Songs))
        .on("mouseover", function(event, d) {
            d3.select(this).attr("opacity", 0.8);
            tooltip.html(`${d.Title}<br>${d.Songs}首`)
                .style("visibility", "visible");
        })
        .on("mousemove", function(event) {
            tooltip.style("top", `${event.pageY - 10}px`)
                .style("left", `${event.pageX + 10}px`);
        })
        .on("mouseout", function() {
            d3.select(this).attr("opacity", 1);
            tooltip.style("visibility", "hidden");
        });
    
    // 添加数值标签
    svg.selectAll(".label")
        .data(data)
        .enter()
        .append("text")
        .attr("class", "label")
        .attr("x", d => x(d.Songs) + 5)
        .attr("y", d => y(d.Title) + y.bandwidth()/2)
        .attr("dy", "0.35em")
        .text(d => d.Songs)
        .style("font-size", "12px")
        .style("fill", "#333");
    
    // 添加Y轴
    svg.append("g")
        .call(d3.axisLeft(y).tickSize(0))
        .selectAll("text")
        .style("font-size", "12px");
    
    // 添加X轴
    svg.append("g")
        .attr("transform", `translate(0,${height})`)
        .call(d3.axisBottom(x).ticks(5))
        .selectAll("text")
        .style("font-size", "12px");

    svg.append("text")
    .attr("x", width / 2)
    .attr("y", height + margin.bottom - 2)  // 放在X轴下方
    .attr("text-anchor", "middle")
    .style("font-size", "18px")
    .style("font-weight", "bold")
    .text(`共 ${d3.sum(data, d => d.Songs)} 首歌曲`);
}

function drawStreamsChart(data) {

const albumIndexMap = new Map(data.map((d, i) => [d.Code, i]));

  // 1. 设置图表尺寸和边距
  const margin = {top: 40, right: 40, bottom: 60, left: 60};
  const width = 800 - margin.left - margin.right;
  const height = 400 - margin.top - margin.bottom;

  // 2. 创建SVG画布
  const svg = d3.select("#streams-chart")
    .attr("width", "100%") // 响应式宽度
    .attr("height", height + margin.top + margin.bottom)
    .attr("viewBox", `0 0 ${width + margin.left + margin.right} ${height + margin.top + margin.bottom}`)
    .append("g")
    .attr("transform", `translate(${margin.left},${margin.top})`);

  // 3. 定义比例尺（注意：x轴使用索引保持原始顺序）
const x = d3.scaleBand()
  .domain(data.map((d, i) => d.Code)) // 直接使用专辑名
  .range([0, width])
  .padding(0.2);

const y = d3.scaleLinear()
  .domain([0, d3.max(data, d => d.Streams) * 1.6])
  .range([height, 0]);

const xAxis = g => g
  .attr("transform", `translate(0,${height})`)
  .call(d3.axisBottom(x))
  .call(g => g.select(".domain").remove())
  .call(g => g.selectAll("text")
    .attr("transform", "rotate(-40)")
    .style("text-anchor", "end")
    .attr("dx", "-0.5em")
    .attr("dy", "0.5em")
    .style("font-size", "10px")); // 统一字号

const yAxis = g => g
  .call(d3.axisLeft(y)
    .tickFormat(d => `${d}亿次`)
    .tickSizeOuter(0))
  .call(g => g.select(".domain").remove())
  .call(g => g.selectAll(".tick text")
    .style("text-anchor", "end") // 右对齐
    .style("font-size", "12px"));

// 3.2 绘制坐标轴
svg.append("g").call(xAxis);
svg.append("g").call(yAxis);

//   svg.append("g")
//     .attr("transform", `translate(0,${height})`)
//     .call(d3.axisBottom(x).tickSize(0)) // 先隐藏默认标签
//     .selectAll(".tick text")
//     .text((d, i) => data[i].Album) // 自定义标签
//     .style("font-size", "10px")
//     .attr("transform", "rotate(-40)")
//     .attr("text-anchor", "end");
// 3.3 添加坐标轴标题
svg.append("text")
    .attr("x", width / 2)
    .attr("y", height + margin.bottom - 10)
    .attr("text-anchor", "middle")
    .text("专辑发行顺序");

svg.append("text")
    .attr("x", -margin.left)  // 更靠左
    .attr("y", -15)           // 上方偏移量
    .attr("text-anchor", "start")  // 左对齐
    .style("font-size", "13px")
    .style("font-weight", "bold")
    .text("Spotify播放量（亿次）");

  // 4. 绘制折线
  const line = d3.line()
    .x(d => x(d.Code) + x.bandwidth() / 2)
    .y(d => y(d.Streams));

  svg.append("path")
    .datum(data)
    .attr("fill", "none")
    .attr("stroke", "#FF8C00")
    .attr("stroke-width", 3)
    .attr("d", line);

  // 5. 添加坐标轴（示例代码，需完整实现）
  // ... (x轴显示专辑名称，y轴显示"亿次")

const tooltip = d3.select("body").append("div")
    .attr("class", "tooltip")
    .style("position", "absolute") // 新增
    .style("z-index", "9999") // 新增
    .style("opacity", 0);

// 4.1 绘制圆形交互点
svg.selectAll(".dot")
    .data(data)
    .enter()
    .append("circle")
    .attr("class", "dot")
    .attr("cx", d => x(d.Code) + x.bandwidth() / 2)
    .attr("cy", d => y(d.Streams))
    .attr("r", 6)
    .attr("fill", "#FF8C00")
    .attr("stroke", "white")
    .attr("stroke-width", 2)
    .on("mouseover", function(event, d) {
        tooltip
            .html(`
                <div class="tooltip-title">${d.Title}</div>
                <div>播放量: <strong>${d.Streams}亿次</strong></div>
                <div>发行年: ${d.ReleaseDate?.split("-")[0] || d.Year}</div>
            `)
            .style("left", `${event.pageX + 15}px`)
            .style("top", `${event.pageY - 45}px`)
            .transition()
            .duration(100)
            .style("opacity", 1);
    })
    .on("mouseout", function() {
        tooltip.transition()
            .duration(500)
            .style("opacity", 0);
    });
}
    </script>

<script>
// 通用Top Songs柱状图绘制函数
function renderTopSongsChart(containerId, data, albumColor = "#1D4737") {
    // 清除容器原有内容
    d3.select(`#${containerId}`).html("");
    
    // 设置边距和尺寸
    const margin = {top: 30, right: 100, bottom: 50, left: 300},
          width = document.querySelector(`#${containerId}`).parentElement.clientWidth - margin.left - margin.right,
          height = 400 - margin.top - margin.bottom;

    // 创建SVG
    const svg = d3.select(`#${containerId}`)
        .attr("viewBox", `0 0 ${width + margin.left + margin.right} ${height + margin.top + margin.bottom}`)
        .append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);

    // 比例尺
    const x = d3.scaleLinear()
        .domain([0, d3.max(data, d => d.streams)])
        .range([0, width])
        .nice();

    const y = d3.scaleBand()
        .domain(data.map(d => d.name))
        .range([0, height])
        .padding(0.2);

    // 绘制条形
    svg.selectAll(".bar")
        .data(data)
        .enter().append("rect")
        .attr("class", "bar")
        .attr("y", d => y(d.name))
        .attr("width", d => x(d.streams))
        .attr("height", y.bandwidth())
        .attr("fill", albumColor)
        .attr("rx", 4)
        .attr("ry", 4);

    // 添加歌曲名称标签
    svg.selectAll(".song-label")
        .data(data)
        .enter().append("text")
        .attr("class", "song-label")
        .attr("y", d => y(d.name) + y.bandwidth() / 2)
        .attr("x", -10)
        .attr("dy", "0.35em")
        .attr("text-anchor", "end")
        .text(d => d.name)
        .style("fill", albumColor)
        .style("font-size", "18px");

    // 添加播放量数值标签
    svg.selectAll(".streams-label")
        .data(data)
        .enter().append("text")
        .attr("class", "streams-label")
        .attr("y", d => y(d.name) + y.bandwidth() / 2)
        .attr("x", d => x(d.streams) + 10)
        .attr("dy", "0.35em")
        .text(d => d3.format(",")(d.streams))
        .style("fill", "black")
        .style("font-size", "13px")
        .style("font-weight", "bold");

    // 添加X轴
    svg.append("g")
        .attr("class", "x-axis")
        .attr("transform", `translate(0,${height})`)
        .call(d3.axisBottom(x).ticks(5).tickFormat(d => d3.format(".2s")(d)))
        .style("color", "#555");

    // 添加轴标题
    svg.append("text")
        .attr("x", width / 2)
        .attr("y", -10)
        .attr("text-anchor", "middle")
        .style("font-size", "14px")
        .style("font-weight", "bold")
        .text("播放量 (次)");
}

// 使用示例 (放在DOM加载完成后)
document.addEventListener('DOMContentLoaded', function() {
    // Taylor Swift专辑数据
    const tsData = [
        {name: "Our Song", rank: 1, streams: 381079025},
        {name: "Teardrops on My Guitar", rank: 2, streams: 230912121},
        {name: "Picture to Burn", rank: 3, streams: 214738354},
        {name: "Tim McGraw", rank: 4, streams: 143295618},
        {name: "Should've Said No", rank: 5, streams: 133982292},
        {name: "I'm Only Me When I'm with You", rank: 6, streams: 56984746}
    ];

    const ferData = [
        {name: "Love Story", rank: 1, streams: 1846727185},
        {name: "You Belong With Me", rank: 2, streams: 1477845320},
        {name: "The Way I Loved You", rank: 3, streams: 533133086},
        {name: "Fearless", rank: 4, streams: 485048681},
        {name: "Mr. Perfectly Fine (Vault)", rank: 5, streams: 402348529},
        {name: "Fifteen", rank: 6, streams: 234159974}
    ];
    
    // 调用函数渲染图表
    renderTopSongsChart("tsw-chart", tsData, "#1D4737");
    renderTopSongsChart("fer-chart", ferData, "#6E4823");
    
    // 其他专辑调用示例 (假设有不同颜色)
    // renderTopSongsChart("fearless-chart", fearlessData, "#D4AF37"); 
    // renderTopSongsChart("red-chart", redData, "#FF0000");
});
</script>
</body>
</html>
