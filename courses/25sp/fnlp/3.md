# Lecture 3 - Classification
Fundamentals of Natural Language Processing, 2025 Spring

?> æœ¬è¯¾ç¨‹ç¬”è®°æ•´ç†è‡ªè‰é±¼ï¼Œéƒ¨åˆ†è¡¥å……å†…å®¹ç”± deepseek æˆ– gpt ç”Ÿæˆã€‚å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡æ­£ï¼

!> **é‡ç‚¹å†…å®¹ï¼š** ç”Ÿæˆå¼æ¨¡å‹å’Œåˆ¤åˆ«å¼æ¨¡å‹

## Generative VS Discriminative
ä¸ŠèŠ‚è¯¾æˆ‘ä»¬æ¥è§¦åˆ°äº†è¯ä¹‰æ¶ˆæ­§çš„ä»»åŠ¡ï¼Œå¹¶ä¸”å°è¯•ç”¨æœ´ç´ è´å¶æ–¯æ–¹æ³•è§£å†³è¯¥é—®é¢˜ã€‚è¯ä¹‰æ¶ˆæ­§ï¼ˆWord Sense Disambiguation, WSDï¼‰æ—¨åœ¨æ ¹æ®ä¸Šä¸‹æ–‡ç¡®å®šå¤šä¹‰è¯çš„æ­£ç¡®å«ä¹‰ï¼ŒNaÃ¯ve Bayesï¼ˆæœ´ç´ è´å¶æ–¯ï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„ç»Ÿè®¡æ–¹æ³•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯åŸºäºè´å¶æ–¯å®šç†ï¼Œé€šè¿‡è®¡ç®—ç»™å®šä¸Šä¸‹æ–‡ä¸­æ¯ä¸ªå¯èƒ½è¯ä¹‰çš„æ¡ä»¶æ¦‚ç‡ï¼Œé€‰æ‹©æ¦‚ç‡æœ€å¤§çš„è¯ä¹‰ä½œä¸ºæœ€ç»ˆç»“æœã€‚å…·ä½“å…¬å¼ä¸ºï¼š

$$ \text{sense}^* = \arg\max_{\text{sense}} P(\text{sense}) \prod_{\text{word} \in C} P(\text{word}|\text{sense}) $$

å…¶ä¸­ï¼Œ\( P(\text{sense}) \) æ˜¯è¯ä¹‰ï¼ˆsenseï¼‰çš„å…ˆéªŒæ¦‚ç‡ï¼Œ\( P(\text{word}|\text{sense}) \) æ˜¯åœ¨ç»™å®šè¯ä¹‰ä¸‹ï¼Œä¸Šä¸‹æ–‡ä¸­æŸä¸ªè¯ï¼ˆwordï¼‰å‡ºç°çš„æ¡ä»¶æ¦‚ç‡ã€‚é€šè¿‡æœ€å¤§åŒ–è¿™äº›æ¦‚ç‡çš„ä¹˜ç§¯ï¼Œæ¨¡å‹å¯ä»¥é¢„æµ‹æœ€å¯èƒ½çš„è¯ä¹‰ã€‚

åœ¨**ç›‘ç£å­¦ä¹ **çš„æ¡†æ¶ä¸‹ï¼ŒWSDä»»åŠ¡ä¾èµ–äºæ ‡æ³¨æ•°æ®ã€‚æ ‡æ³¨æ•°æ®çš„å½¢å¼ä¸º \( (x_1, y_1), (x_2, y_2), \dots, (x_m, y_m) \)ï¼Œå…¶ä¸­ \( x_i \) æ˜¯æ•°æ®æ ·æœ¬ï¼ˆä¾‹å¦‚åŒ…å«ç›®æ ‡è¯çš„å¥å­ï¼‰ï¼Œ\( y_i \) æ˜¯å¯¹åº”çš„æ ‡ç­¾ï¼ˆä¾‹å¦‚ç›®æ ‡è¯çš„è¯ä¹‰ï¼‰ã€‚ç›‘ç£å­¦ä¹ çš„ç›®æ ‡æ˜¯é€šè¿‡è¿™äº›æ ‡æ³¨æ•°æ®è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œæ‰¾åˆ°ä¸€ä¸ªå‡½æ•° \( g \)ï¼Œä½¿å¾— \( y = g(x) \)ï¼Œå³æ¨¡å‹èƒ½å¤Ÿæ ¹æ®è¾“å…¥ \( x \) é¢„æµ‹å‡ºæ­£ç¡®çš„è¯ä¹‰ \( y \)ã€‚

?> **The Goal: find a function g such that** \( y = g(x) \)

ä»æ¦‚ç‡çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸€ç›®æ ‡å¯ä»¥å½¢å¼åŒ–ä¸ºæ¡ä»¶æ¦‚ç‡ \( p(y|x) \)ï¼Œå³ç»™å®šè¾“å…¥ \( x \) æ—¶è¾“å‡º \( y \) çš„æ¦‚ç‡åˆ†å¸ƒã€‚å…·ä½“æ¥è¯´ï¼Œå‡½æ•° \( g(x) \) å¯ä»¥è¢«å®šä¹‰ä¸ºï¼š

$$ g(x) = \arg\max_{y} p(y|x) $$

ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¨¡å‹çš„ç›®æ ‡æ˜¯æ‰¾åˆ°åœ¨ç»™å®šè¾“å…¥ \( x \) çš„æ¡ä»¶ä¸‹ï¼Œæœ€æœ‰å¯èƒ½çš„è¾“å‡º \( y \)ã€‚

ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œæœºå™¨å­¦ä¹ ä¸­æœ‰ä¸¤ç§ä¸»è¦çš„å»ºæ¨¡è§†è§’ï¼š**åˆ¤åˆ«æ¨¡å‹ï¼ˆDiscriminative Modelsï¼‰** å’Œ **ç”Ÿæˆæ¨¡å‹ï¼ˆGenerative Modelsï¼‰**ã€‚è¿™ä¸¤ç§æ–¹æ³•åœ¨å¦‚ä½•å»ºæ¨¡å’Œåˆ©ç”¨æ¦‚ç‡åˆ†å¸ƒä¸Šæœ‰æ‰€ä¸åŒã€‚æˆ‘ä»¬å…ˆä»å®è§‚ä¸Šå¯¹æ¯”ä¸€ä¸‹è¿™ä¸¤ç§æ¨¡å‹ã€‚

---

**åˆ¤åˆ«æ¨¡å‹**

åˆ¤åˆ«æ¨¡å‹ï¼ˆDiscriminative Modelsï¼‰çš„æ ¸å¿ƒæ€æƒ³æ˜¯**ç›´æ¥å­¦ä¹ æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ** \( p(y|x) \)ã€‚æ¢å¥è¯è¯´ï¼Œåˆ¤åˆ«æ¨¡å‹å…³æ³¨çš„æ˜¯è¾“å…¥ \( x \) å’Œè¾“å‡º \( y \) ä¹‹é—´çš„ç›´æ¥æ˜ å°„å…³ç³»ï¼Œè€Œä¸éœ€è¦æ˜¾å¼åœ°å»ºæ¨¡è¾“å…¥çš„åˆ†å¸ƒ \( p(x) \)ã€‚åˆ¤åˆ«æ¨¡å‹çš„ç›®æ ‡æ˜¯é€šè¿‡è®­ç»ƒæ•°æ®ç›´æ¥å­¦ä¹ ä¸€ä¸ªå†³ç­–è¾¹ç•Œï¼Œä»è€Œèƒ½å¤Ÿå¯¹æ–°çš„è¾“å…¥ \( x \) è¿›è¡Œé¢„æµ‹ã€‚

- **ä¼˜ç‚¹**ï¼š
  - åˆ¤åˆ«æ¨¡å‹é€šå¸¸æ›´ç®€å•ï¼Œå› ä¸ºå®ƒåªéœ€è¦å…³æ³¨ \( p(y|x) \)ï¼Œè€Œä¸éœ€è¦å»ºæ¨¡è¾“å…¥çš„å¤æ‚åˆ†å¸ƒã€‚
  - åœ¨åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œåˆ¤åˆ«æ¨¡å‹é€šå¸¸è¡¨ç°æ›´å¥½ï¼Œå› ä¸ºå®ƒç›´æ¥ä¼˜åŒ–äº†åˆ†ç±»è¾¹ç•Œã€‚
- **å…¸å‹æ–¹æ³•**ï¼š
  - é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰
  - æ”¯æŒå‘é‡æœºï¼ˆSupport Vector Machines, SVMï¼‰
  - ç¥ç»ç½‘ç»œï¼ˆNeural Networksï¼‰
  - æ¡ä»¶éšæœºåœºï¼ˆConditional Random Fields, CRFï¼‰

ä¾‹å¦‚ï¼Œåœ¨è¯ä¹‰æ¶ˆæ­§ä»»åŠ¡ä¸­ï¼Œåˆ¤åˆ«æ¨¡å‹ä¼šç›´æ¥å­¦ä¹ ç»™å®šä¸Šä¸‹æ–‡ \( x \)ï¼ˆåŒ…å«ç›®æ ‡è¯çš„å¥å­ï¼‰æ—¶ï¼Œæ¯ä¸ªè¯ä¹‰ \( y \) çš„æ¡ä»¶æ¦‚ç‡ \( p(y|x) \)ï¼Œç„¶åé€‰æ‹©æ¦‚ç‡æœ€å¤§çš„è¯ä¹‰ä½œä¸ºé¢„æµ‹ç»“æœã€‚

---

**ç”Ÿæˆæ¨¡å‹**

ç”Ÿæˆæ¨¡å‹ï¼ˆGenerative Modelsï¼‰çš„æ ¸å¿ƒæ€æƒ³æ˜¯**å…ˆå­¦ä¹ è”åˆæ¦‚ç‡åˆ†å¸ƒ** \( p(x, y) \)ï¼Œç„¶åé€šè¿‡**è´å¶æ–¯å®šç†**æ¨å¯¼å‡ºæ¡ä»¶æ¦‚ç‡ \( p(y|x) \)ã€‚ç”Ÿæˆæ¨¡å‹ä¸ä»…å…³æ³¨è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„å…³ç³»ï¼Œè¿˜è¯•å›¾å»ºæ¨¡è¾“å…¥æ•°æ® \( x \) çš„åˆ†å¸ƒ \( p(x) \)ã€‚é€šè¿‡å­¦ä¹ è”åˆåˆ†å¸ƒï¼Œç”Ÿæˆæ¨¡å‹å¯ä»¥ç”Ÿæˆæ–°çš„æ•°æ®æ ·æœ¬ã€‚

- **ä¼˜ç‚¹**ï¼š
  - ç”Ÿæˆæ¨¡å‹èƒ½å¤Ÿç”Ÿæˆæ–°çš„æ•°æ®ï¼Œå› æ­¤åœ¨æŸäº›ä»»åŠ¡ï¼ˆå¦‚æ–‡æœ¬ç”Ÿæˆã€å›¾åƒç”Ÿæˆï¼‰ä¸­éå¸¸æœ‰ç”¨ã€‚
  - å®ƒå¯ä»¥æ›´å¥½åœ°å¤„ç†ç¼ºå¤±æ•°æ®æˆ–å™ªå£°æ•°æ®ã€‚
- **å…¸å‹æ–¹æ³•**ï¼š
  - æœ´ç´ è´å¶æ–¯ï¼ˆNaÃ¯ve Bayesï¼‰
  - éšé©¬å°”å¯å¤«æ¨¡å‹ï¼ˆHidden Markov Models, HMMï¼‰
  - é«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGaussian Mixture Models, GMMï¼‰

ä¾‹å¦‚ï¼Œåœ¨è¯ä¹‰æ¶ˆæ­§ä»»åŠ¡ä¸­ï¼Œç”Ÿæˆæ¨¡å‹ä¼šå…ˆå­¦ä¹ è”åˆåˆ†å¸ƒ \( p(x, y) \)ï¼Œå³ä¸Šä¸‹æ–‡ \( x \) å’Œè¯ä¹‰ \( y \) åŒæ—¶å‡ºç°çš„æ¦‚ç‡ï¼Œç„¶åé€šè¿‡è´å¶æ–¯å®šç†è®¡ç®—æ¡ä»¶æ¦‚ç‡ \( p(y|x) = \frac{p(x, y)}{p(x)} \)ï¼Œæœ€åé€‰æ‹©æœ€å¯èƒ½çš„è¯ä¹‰ã€‚

![alt text](image-4.png 'size=60%')

?> **ä¸¤ç§è§†è§’çš„å¯¹æ¯”** åˆ¤åˆ«æ¨¡å‹æ›´å…³æ³¨è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„ç›´æ¥å…³ç³»ï¼Œé€‚åˆåˆ†ç±»ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯åœ¨æ•°æ®é‡è¾ƒå¤§æ—¶è¡¨ç°æ›´å¥½ã€‚ç”Ÿæˆæ¨¡å‹åˆ™æ›´å…¨é¢åœ°å»ºæ¨¡æ•°æ®çš„åˆ†å¸ƒï¼Œé€‚åˆç”Ÿæˆä»»åŠ¡æˆ–éœ€è¦å¤„ç†æ•°æ®åˆ†å¸ƒçš„åœºæ™¯ï¼Œä½†åœ¨åˆ†ç±»ä»»åŠ¡ä¸­å¯èƒ½å› ä¸ºå»ºæ¨¡å¤æ‚åº¦è¾ƒé«˜è€Œè¡¨ç°ä¸å¦‚åˆ¤åˆ«æ¨¡å‹ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€‰æ‹©å“ªç§æ¨¡å‹å–å†³äºå…·ä½“ä»»åŠ¡çš„éœ€æ±‚ã€‚

ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†ä»‹ç»è¿™ä¸¤ç§æ¨¡å‹ã€‚

---

### Generative Models

ç”Ÿæˆæ¨¡å‹ï¼ˆGenerative Modelsï¼‰çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å»ºæ¨¡è”åˆæ¦‚ç‡åˆ†å¸ƒ \( p(x, y) \) æ¥å­¦ä¹ è¾“å…¥æ•°æ® \( x \) å’Œç±»åˆ« \( y \) ä¹‹é—´çš„å…³ç³»ã€‚ä¸åˆ¤åˆ«æ¨¡å‹ç›´æ¥å­¦ä¹ æ¡ä»¶æ¦‚ç‡ \( p(y|x) \) ä¸åŒï¼Œç”Ÿæˆæ¨¡å‹ä»è”åˆåˆ†å¸ƒ \( p(x, y) \) å‡ºå‘ï¼Œåˆ©ç”¨è´å¶æ–¯å®šç†æ¨å¯¼å‡ºæ¡ä»¶æ¦‚ç‡ \( p(y|x) \)ã€‚ä»¥ä¸‹æ˜¯ç”Ÿæˆæ¨¡å‹çš„è¯¦ç»†æ¨å¯¼è¿‡ç¨‹åŠå…¶èƒŒåçš„é€»è¾‘ï¼š

---

**1. è”åˆæ¦‚ç‡åˆ†å¸ƒ \( p(x, y) \)**

ç”Ÿæˆæ¨¡å‹é¦–å…ˆå…³æ³¨çš„æ˜¯è”åˆæ¦‚ç‡åˆ†å¸ƒ \( p(x, y) \)ï¼Œå³è¾“å…¥æ•°æ® \( x \) å’Œç±»åˆ« \( y \) åŒæ—¶å‡ºç°çš„æ¦‚ç‡ã€‚æ ¹æ®æ¦‚ç‡çš„é“¾å¼æ³•åˆ™ï¼Œè”åˆåˆ†å¸ƒå¯ä»¥åˆ†è§£ä¸ºï¼š

$$ p(x, y) = p(y) \cdot p(x|y) $$

å…¶ä¸­ï¼š
- \( p(y) \) æ˜¯ç±»åˆ« \( y \) çš„å…ˆéªŒæ¦‚ç‡ï¼Œè¡¨ç¤ºç±»åˆ« \( y \) åœ¨æ•°æ®ä¸­å‡ºç°çš„æ¦‚ç‡ã€‚
- \( p(x|y) \) æ˜¯æ¡ä»¶æ¦‚ç‡ï¼Œè¡¨ç¤ºåœ¨ç±»åˆ« \( y \) ä¸‹ï¼Œæ•°æ® \( x \) çš„ç”Ÿæˆæ¦‚ç‡ã€‚

---

**2. åˆ©ç”¨è´å¶æ–¯å®šç†æ¨å¯¼æ¡ä»¶æ¦‚ç‡ \( p(y|x) \)**

ç”Ÿæˆæ¨¡å‹çš„æœ€ç»ˆç›®æ ‡æ˜¯è®¡ç®—æ¡ä»¶æ¦‚ç‡ \( p(y|x) \)ï¼Œå³åœ¨ç»™å®šè¾“å…¥æ•°æ® \( x \) çš„æƒ…å†µä¸‹ï¼Œç±»åˆ« \( y \) çš„æ¦‚ç‡ã€‚æ ¹æ®è´å¶æ–¯å®šç†ï¼Œæ¡ä»¶æ¦‚ç‡ \( p(y|x) \) å¯ä»¥é€šè¿‡è”åˆåˆ†å¸ƒ \( p(x, y) \) å’Œè¾¹ç¼˜åˆ†å¸ƒ \( p(x) \) è®¡ç®—å¾—åˆ°ï¼š

$$ p(y|x) = \frac{p(x, y)}{p(x)} $$

å…¶ä¸­ï¼Œè¾¹ç¼˜åˆ†å¸ƒ \( p(x) \) å¯ä»¥é€šè¿‡å¯¹æ‰€æœ‰å¯èƒ½çš„ç±»åˆ« \( y' \) æ±‚å’Œå¾—åˆ°ï¼š

$$ p(x) = \sum_{y'} p(y') \cdot p(x|y') $$

å› æ­¤ï¼Œæ¡ä»¶æ¦‚ç‡ \( p(y|x) \) å¯ä»¥è¿›ä¸€æ­¥è¡¨ç¤ºä¸ºï¼š

$$ p(y|x) = \frac{p(y) \cdot p(x|y)}{\sum_{y'} p(y') \cdot p(x|y')} $$

---

**3. é¢„æµ‹å‡½æ•° \( g(x) \) çš„æ¨å¯¼**

ç”Ÿæˆæ¨¡å‹çš„é¢„æµ‹å‡½æ•° \( g(x) \) çš„ç›®æ ‡æ˜¯æ‰¾åˆ°åœ¨ç»™å®šè¾“å…¥ \( x \) æ—¶ï¼Œæœ€å¯èƒ½çš„ç±»åˆ« \( y \)ã€‚æ ¹æ®æœ€å¤§åéªŒæ¦‚ç‡ï¼ˆMAPï¼‰å‡†åˆ™ï¼Œé¢„æµ‹å‡½æ•°å¯ä»¥è¡¨ç¤ºä¸ºï¼š

$$ g(x) = \arg\max_{y} p(y|x) $$

å°†æ¡ä»¶æ¦‚ç‡ \( p(y|x) \) çš„è¡¨è¾¾å¼ä»£å…¥ï¼Œå¯ä»¥å¾—åˆ°ï¼š

$$ g(x) = \arg\max_{y} \frac{p(y) \cdot p(x|y)}{\sum_{y'} p(y') \cdot p(x|y')} $$

æ³¨æ„åˆ°åˆ†æ¯ \( \sum_{y'} p(y') \cdot p(x|y') \) å¯¹äºæ‰€æœ‰ç±»åˆ« \( y \) éƒ½æ˜¯ç›¸åŒçš„ï¼Œå› æ­¤åœ¨æœ€å¤§åŒ–è¿‡ç¨‹ä¸­å¯ä»¥å¿½ç•¥ã€‚äºæ˜¯ï¼Œé¢„æµ‹å‡½æ•°ç®€åŒ–ä¸ºï¼š

$$ g(x) = \arg\max_{y} p(y) \cdot p(x|y) $$

è¿›ä¸€æ­¥åœ°ï¼Œç”±äº \( p(y) \cdot p(x|y) = p(x, y) \)ï¼Œé¢„æµ‹å‡½æ•°ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸ºï¼š

$$ g(x) = \arg\max_{y} p(x, y) $$

---

**4. ç”Ÿæˆæ¨¡å‹çš„æœ€ç»ˆå½¢å¼**

ç»¼ä¸Šæ‰€è¿°ï¼Œç”Ÿæˆæ¨¡å‹çš„é¢„æµ‹å‡½æ•°æœ€ç»ˆå¯ä»¥å†™æˆä»¥ä¸‹ä¸¤ç§ç­‰ä»·å½¢å¼ï¼š

1. **åŸºäºè”åˆåˆ†å¸ƒçš„å½¢å¼**ï¼š
   $$ g(x) = \arg\max_{y} p(x, y) $$

2. **åŸºäºå…ˆéªŒå’Œæ¡ä»¶åˆ†å¸ƒçš„å½¢å¼**ï¼š
   $$ g(x) = \arg\max_{y} p(y) \cdot p(x|y) $$

è¿™ä¸¤ç§å½¢å¼éƒ½ä½“ç°äº†ç”Ÿæˆæ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³ï¼šé€šè¿‡å»ºæ¨¡è”åˆåˆ†å¸ƒ \( p(x, y) \) æˆ–åˆ†è§£ä¸º \( p(y) \) å’Œ \( p(x|y) \)ï¼Œæ¥æ¨å¯¼æ¡ä»¶æ¦‚ç‡ \( p(y|x) \)ï¼Œå¹¶æœ€ç»ˆç”¨äºé¢„æµ‹ã€‚

?> ç„¶è€Œï¼Œå¾ˆå¤šæƒ…å†µä¸‹ï¼Œ\( p(x|y) \) æ˜¯å¾ˆéš¾ç›´æ¥è®¡ç®—çš„ï¼Œå› æ­¤ç”Ÿæˆæ¨¡å‹é€šå¸¸ä¼šåšä¸€äº›å‡è®¾ï¼Œ**å¦‚æœ´ç´ è´å¶æ–¯ä¸­çš„ç‰¹å¾æ¡ä»¶ç‹¬ç«‹æ€§å‡è®¾**ï¼Œæ¥ç®€åŒ–è®¡ç®—ã€‚

> ä¾‹ï¼šå›¾ä¹¦åˆ†ç±»

**é—®é¢˜æè¿°**

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¹¦ç±åˆ†ç±»ä»»åŠ¡ï¼Œç›®æ ‡æ˜¯é¢„æµ‹ä¸€æœ¬ä¹¦çš„ç±»åˆ« \( Y \)ï¼ˆä¾‹å¦‚ä¾¦æ¢å°è¯´ã€ç§‘å¹»å°è¯´ç­‰ï¼‰ï¼ŒåŸºäºä¹¦ä¸­çš„è¯æ±‡ \( X \)ã€‚æˆ‘ä»¬éœ€è¦å»ºæ¨¡ä»¥ä¸‹ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼š
1. **æ¡ä»¶æ¦‚ç‡** \( P(X|Y) \)ï¼šåœ¨ç»™å®šä¹¦ç±ç±»åˆ« \( Y \) çš„æƒ…å†µä¸‹ï¼Œä¹¦ä¸­è¯æ±‡ \( X \) çš„åˆ†å¸ƒã€‚ä¾‹å¦‚ï¼Œä¾¦æ¢å°è¯´ä¸­å¯èƒ½ä¼šé¢‘ç¹å‡ºç°â€œè°‹æ€â€ã€â€œä¾¦æ¢â€ç­‰è¯æ±‡ã€‚
2. **åéªŒæ¦‚ç‡** \( P(Y|X) \)ï¼šè¿™æ˜¯æˆ‘ä»¬æœ€ç»ˆæ„Ÿå…´è¶£çš„ï¼Œå³åœ¨ç»™å®šè¯æ±‡ \( X \) çš„æƒ…å†µä¸‹ï¼Œä¹¦ç±ç±»åˆ« \( Y \) çš„æ¦‚ç‡ã€‚

---

**è´å¶æ–¯å»ºæ¨¡çš„å‡è®¾**

ä¸ºäº†å»ºæ¨¡è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›å‡è®¾ï¼Œå¹¶å¼•å…¥æ¦‚ç‡åˆ†å¸ƒæ¥æè¿°æ•°æ®ç”Ÿæˆè¿‡ç¨‹ã€‚

**ä¹¦ç±ç±»åˆ«çš„ç”Ÿæˆ**

å‡è®¾ä¹¦ç±ç±»åˆ« \( Y \) æ˜¯ä»ä¸€ä¸ªå¤šé¡¹å¼åˆ†å¸ƒï¼ˆMultinomial Distributionï¼‰ä¸­ç”Ÿæˆçš„ï¼Œå…¶å‚æ•°ä¸º \( \gamma \)ï¼š

$$ Y \sim \text{Multinomial}(\gamma) $$

å…¶ä¸­ï¼Œ\( \gamma \) æ˜¯ä¸€ä¸ªæ¦‚ç‡å‘é‡ï¼Œè¡¨ç¤ºæ¯ä¸ªç±»åˆ«çš„å…ˆéªŒæ¦‚ç‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰ä¾¦æ¢ã€ç§‘å¹»ã€å†å²ä¸‰ç±»å°è¯´ï¼Œä»–ä»¬åœ¨æ€»ä½“ä¸­å‡ºç°çš„æ¦‚ç‡åˆ†åˆ«ä¸º \( \gamma = [0.35, 0.4, 0.25] \)ã€‚è¿™å°±æ˜¯æ¦‚ç‡å‘é‡ã€‚

?> ğŸ’¡ **å¤šé¡¹å¼åˆ†å¸ƒ**ï¼ˆMultinomial Distributionï¼‰æ˜¯äºŒé¡¹åˆ†å¸ƒçš„æ¨å¹¿ï¼Œç”¨äºæè¿°åœ¨å¤šæ¬¡ç‹¬ç«‹è¯•éªŒä¸­ï¼Œå¤šä¸ªç±»åˆ«ï¼ˆæˆ–ç»“æœï¼‰å‡ºç°æ¬¡æ•°çš„æ¦‚ç‡åˆ†å¸ƒã€‚å‡è®¾æ¯æ¬¡è¯•éªŒæœ‰ \( k \) ç§å¯èƒ½çš„ç»“æœï¼Œæ¯ç§ç»“æœå‡ºç°çš„æ¦‚ç‡åˆ†åˆ«ä¸º \( p_1, p_2, \dots, p_k \)ï¼Œåˆ™åœ¨ \( n \) æ¬¡è¯•éªŒä¸­ï¼Œ**æ¯ç§ç»“æœå‡ºç°æ¬¡æ•°çš„è”åˆæ¦‚ç‡**åˆ†å¸ƒå°±æ˜¯å¤šé¡¹å¼åˆ†å¸ƒã€‚å®ƒå¸¸ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„è¯é¢‘ç»Ÿè®¡ã€åˆ†ç±»ä»»åŠ¡ä¸­çš„ç±»åˆ«åˆ†å¸ƒå»ºæ¨¡ç­‰åœºæ™¯ã€‚

**è¯æ±‡çš„ç”Ÿæˆ**

åœ¨ç»™å®šä¹¦ç±ç±»åˆ« \( Y \) çš„æƒ…å†µä¸‹ï¼Œä¹¦ä¸­çš„è¯æ±‡ \( X \) æ˜¯ä»ä¸€ä¸ªæ¡ä»¶åˆ†å¸ƒ \( p(X|\theta_Y) \) ä¸­ç”Ÿæˆçš„ã€‚è¿™é‡Œï¼Œ\( \theta_Y \) æ˜¯ç±»åˆ« \( Y \) çš„å‚æ•°ï¼Œæè¿°äº†è¯¥ç±»åˆ«çš„è¯æ±‡åˆ†å¸ƒã€‚

$$ X|Y \sim p(X|\theta_Y) $$

ä¾‹å¦‚ï¼Œå¯¹äºä¾¦æ¢å°è¯´ï¼Œ\( \theta_Y \) å¯èƒ½è¡¨ç¤ºâ€œè°‹æ€â€ã€â€œä¾¦æ¢â€ç­‰è¯æ±‡çš„é«˜æ¦‚ç‡ï¼Œè€Œç§‘å¹»å°è¯´å¯èƒ½æ›´å€¾å‘äºâ€œå¤ªç©ºâ€ã€â€œå¤–æ˜Ÿäººâ€ç­‰è¯æ±‡ã€‚

**å…ˆéªŒåˆ†å¸ƒ**

ä¸ºäº†å®Œæˆè´å¶æ–¯å»ºæ¨¡ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå‚æ•° \( \gamma \) å’Œ \( \theta_Y \) æŒ‡å®šå…ˆéªŒåˆ†å¸ƒï¼š
- å¯¹äº \( \gamma \)ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ç‹„åˆ©å…‹é›·åˆ†å¸ƒï¼ˆDirichlet Distributionï¼‰ä½œä¸ºå…ˆéªŒï¼Œå› ä¸ºå®ƒæ˜¯å¤šé¡¹å¼åˆ†å¸ƒçš„å…±è½­å…ˆéªŒï¼š

  $$ \gamma \sim \text{Dirichlet}(\beta) $$

  å…¶ä¸­ï¼Œ\( \beta \) æ˜¯ç‹„åˆ©å…‹é›·åˆ†å¸ƒçš„å‚æ•°ã€‚

- å¯¹äºæ¯ä¸ªç±»åˆ«çš„è¯æ±‡åˆ†å¸ƒå‚æ•° \( \theta_Y \)ï¼Œæˆ‘ä»¬å‡è®¾å®ƒä»¬æ˜¯ä»æŸä¸ªå…ˆéªŒåˆ†å¸ƒ \( p(\theta) \) ä¸­ç‹¬ç«‹åŒåˆ†å¸ƒï¼ˆiidï¼‰ç”Ÿæˆçš„ï¼š

  $$ \theta_1, \theta_2, \dots \sim p(\theta) $$

?> **å…±è½­å…ˆéªŒ**: åœ¨è´å¶æ–¯ç»Ÿè®¡ä¸­ï¼Œå¦‚æœåéªŒåˆ†å¸ƒä¸å…ˆéªŒåˆ†å¸ƒå±äºåŒç±»ï¼Œåˆ™å…ˆéªŒåˆ†å¸ƒä¸åéªŒåˆ†å¸ƒè¢«ç§°ä¸ºå…±è½­åˆ†å¸ƒï¼Œè€Œå…ˆéªŒåˆ†å¸ƒè¢«ç§°ä¸ºä¼¼ç„¶å‡½æ•°çš„å…±è½­å…ˆéªŒã€‚ï¼ˆè¦æ±‚åéªŒåˆ†å¸ƒä¸å…ˆéªŒåˆ†å¸ƒæ˜¯åŒç±»åˆ†å¸ƒï¼Œä¸è¦æ±‚ä¼¼ç„¶å‡½æ•°åˆ†å¸ƒç›¸åŒã€‚ï¼‰

---

**è”åˆæ¦‚ç‡åˆ†å¸ƒ**

åŸºäºä»¥ä¸Šå‡è®¾ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºè”åˆæ¦‚ç‡åˆ†å¸ƒ \( p(X, Y | \gamma, \Theta) \)ï¼Œå…¶ä¸­ \( \Theta = \{\theta_1, \theta_2, \dots\} \) æ˜¯æ‰€æœ‰ç±»åˆ«çš„è¯æ±‡åˆ†å¸ƒå‚æ•°ã€‚è”åˆåˆ†å¸ƒå¯ä»¥åˆ†è§£ä¸ºï¼š

$$ p(X, Y | \gamma, \Theta) = p(X | Y, \Theta) \cdot p(Y | \gamma) $$

å…¶ä¸­ï¼š
- \( p(Y | \gamma) \) æ˜¯ä¹¦ç±ç±»åˆ« \( Y \) çš„ç”Ÿæˆæ¦‚ç‡ï¼Œç”±å¤šé¡¹å¼åˆ†å¸ƒæè¿°ã€‚
- \( p(X | Y, \Theta) \) æ˜¯åœ¨ç»™å®šç±»åˆ« \( Y \) å’Œå‚æ•° \( \Theta \) çš„æƒ…å†µä¸‹ï¼Œè¯æ±‡ \( X \) çš„ç”Ÿæˆæ¦‚ç‡ã€‚

---

**åéªŒæ¦‚ç‡**

æˆ‘ä»¬çš„æœ€ç»ˆç›®æ ‡æ˜¯è®¡ç®—åéªŒæ¦‚ç‡ \( P(Y | X) \)ï¼Œå³åœ¨ç»™å®šè¯æ±‡ \( X \) çš„æƒ…å†µä¸‹ï¼Œä¹¦ç±ç±»åˆ« \( Y \) çš„æ¦‚ç‡ã€‚æ ¹æ®è´å¶æ–¯å®šç†ï¼ŒåéªŒæ¦‚ç‡å¯ä»¥é€šè¿‡è”åˆåˆ†å¸ƒå’Œè¾¹ç¼˜åˆ†å¸ƒè®¡ç®—å¾—åˆ°ï¼š

$$ P(Y | X) = \frac{p(X, Y | \gamma, \Theta)}{p(X | \gamma, \Theta)} $$

å…¶ä¸­ï¼Œè¾¹ç¼˜åˆ†å¸ƒ \( p(X | \gamma, \Theta) \) å¯ä»¥é€šè¿‡å¯¹æ‰€æœ‰å¯èƒ½çš„ç±»åˆ« \( Y \) æ±‚å’Œå¾—åˆ°ï¼š

$$ p(X | \gamma, \Theta) = \sum_{Y} p(X, Y | \gamma, \Theta) $$

?> Bonus æ‹“å±•ï¼š**Latent Dirichlet Allocation** https://zhuanlan.zhihu.com/p/309419680

---

### Discriminative Models

åˆ¤åˆ«æ¨¡å‹ç›´æ¥å»ºæ¨¡æ¡ä»¶æ¦‚ç‡ \( p(y|x) \)ï¼Œå³ç»™å®šè§‚æµ‹æ•°æ® \( x \) æ—¶ï¼Œæœªè§‚æµ‹ç±»åˆ«æ ‡ç­¾ \( y \) çš„æ¦‚ç‡åˆ†å¸ƒã€‚ä¸ç”Ÿæˆæ¨¡å‹ä¸åŒï¼Œåˆ¤åˆ«æ¨¡å‹ä¸å…³æ³¨æ•°æ®çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œè€Œæ˜¯ä¸“æ³¨äºè¾“å…¥ \( x \) å’Œè¾“å‡º \( y \) ä¹‹é—´çš„ç›´æ¥æ˜ å°„å…³ç³»ã€‚

**ç‰¹ç‚¹**ï¼š

1. **ç›´æ¥å»ºæ¨¡æ¡ä»¶æ¦‚ç‡**ï¼šåˆ¤åˆ«æ¨¡å‹ç›´æ¥å­¦ä¹  \( p(y|x) \)ï¼Œè€Œä¸éœ€è¦æ˜¾å¼å»ºæ¨¡è”åˆåˆ†å¸ƒ \( p(x, y) \)ã€‚
2. **æ— éœ€ç‹¬ç«‹æ€§å‡è®¾**ï¼šåˆ¤åˆ«æ¨¡å‹ä¸éœ€è¦å¯¹è¾“å…¥ç‰¹å¾ä¹‹é—´çš„ç‹¬ç«‹æ€§åšå‡ºå‡è®¾ï¼Œå› æ­¤å¯ä»¥æ›´çµæ´»åœ°å¤„ç†å¤æ‚æ•°æ®ã€‚
3. **æ˜“äºèå…¥å¤šç§ç‰¹å¾**ï¼šåˆ¤åˆ«æ¨¡å‹å¯ä»¥è½»æ¾å¼•å…¥å„ç§ç‰¹å¾ï¼ˆå¦‚ä¸Šä¸‹æ–‡ä¿¡æ¯ã€äº¤äº’ç‰¹å¾ç­‰ï¼‰ï¼Œä»è€Œæé«˜æ¨¡å‹è¡¨ç°ã€‚
4. **é€šå¸¸ç²¾åº¦æ›´é«˜**ï¼šç”±äºç›´æ¥ä¼˜åŒ–åˆ†ç±»è¾¹ç•Œï¼Œåˆ¤åˆ«æ¨¡å‹åœ¨åˆ†ç±»ä»»åŠ¡ä¸­é€šå¸¸è¡¨ç°æ›´å¥½ã€‚
5. **å¯èƒ½è¿‡æ‹Ÿåˆ**ï¼šå¦‚æœæ•°æ®é‡ä¸è¶³æˆ–æ¨¡å‹å¤æ‚åº¦è¿‡é«˜ï¼Œåˆ¤åˆ«æ¨¡å‹å®¹æ˜“è¿‡æ‹Ÿåˆã€‚

**å…¸å‹æ–¹æ³•**ï¼š

- **æ¦‚ç‡æ¨¡å‹**ï¼šæœ€å¤§ç†µæ¨¡å‹ï¼ˆMaximum Entropyï¼‰ã€æ¡ä»¶éšæœºåœºï¼ˆConditional Random Field, CRFï¼‰ã€é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰ã€‚
- **éæ¦‚ç‡æ¨¡å‹**ï¼šæ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰ã€æ„ŸçŸ¥æœºï¼ˆPerceptronï¼‰ç­‰ã€‚

**å®ç°æ–¹å¼**ï¼š

åˆ¤åˆ«æ¨¡å‹é€šè¿‡ä¼˜åŒ–æ¡ä»¶æ¦‚ç‡ \( p(y|x) \) çš„å‚æ•°ï¼Œç›´æ¥å­¦ä¹ è¾“å…¥ \( x \) åˆ°è¾“å‡º \( y \) çš„æ˜ å°„å…³ç³»ã€‚å¸¸è§çš„ä¼˜åŒ–æ–¹æ³•åŒ…æ‹¬æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼ˆMLEï¼‰å’Œæ¢¯åº¦ä¸‹é™ç­‰ã€‚

ä¸‹é¢ï¼Œæˆ‘ä»¬ä»¥ Discriminative Models ä¸ºä¾‹ï¼Œä»‹ç»ä¸€ä¸ªç»å…¸çš„åˆ¤åˆ«æ¨¡å‹ï¼š**é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰**ã€‚

## Before Classification: Feature Representation

1. **ç‰¹å¾å®šä¹‰**ï¼š
   - ç‰¹å¾æ˜¯æè¿°è§‚å¯Ÿæ•°æ® \( x \) çš„æŸäº›æ–¹é¢çš„è¯æ®ï¼Œé€šå¸¸ä¸é¢„æµ‹æ ‡ç­¾ \( y \) ç›¸å…³ã€‚
   - ç‰¹å¾æ˜¯ä¸€ä¸ªå…³äº \( x \) å’Œ \( y \) çš„å‡½æ•°ï¼Œ\( f_i(x, y) \in \mathbb{R} \)ã€‚
   - é€šå¸¸ï¼Œç‰¹å¾æ˜¯ä¸€ä¸ªäºŒå…ƒæˆ–æŒ‡ç¤ºå‡½æ•°ï¼Œä¾‹å¦‚åœ¨è¯ä¹‰æ¶ˆæ­§ï¼ˆWSDï¼‰ä¸­ï¼š
     $$
     f_i = 
     \begin{cases} 
     1 & \text{å¦‚æœ } w_{-1} = \text{transfer ä¸” } y = \text{FINANCIAL}, \\
     0 & \text{å¦åˆ™}
     \end{cases}
     $$

2. **ç‰¹å¾å‘é‡**ï¼š
   - å¦‚æœæœ‰ \( m \) ä¸ªæ–¹é¢æ¥æè¿°ä¸€ä¸ªå®ä¾‹ï¼Œå³ \( m \) ä¸ªç‰¹å¾ï¼Œé‚£ä¹ˆæ¯ä¸ªå®ä¾‹ \( (x, y) \) çš„ç‰¹å¾å‘é‡ä¸ºï¼š
     $$
     [f_1(x, y), f_2(x, y), f_3(x, y), \ldots, f_m(x, y)]
     $$
   - ä¾‹å¦‚ï¼Œç‰¹å¾å‘é‡å¯èƒ½çœ‹èµ·æ¥åƒï¼š\( [1, 0, 0, \ldots, 1, 0] \)ã€‚

![alt text](image-9.png ':size=60%')


**åœ¨ WSD ä¸­çš„ç¤ºä¾‹**

![alt text](image-10.png ':size=60%')

**åœ¨æ–°é—»åˆ†ç±»ä¸­çš„ç¤ºä¾‹**

$$
f_{around, Sp} = 1, f_{soccer, Sp} = 1, f_{Portugal, Sp} = 0, \cdots, f_{Portugal, notSp} = 1
$$

æˆ‘ä»¬å¯ä»¥æŠŠç‰¹å¾å‘é‡æ’åˆ—èµ·æ¥ï¼Œ$[1,1,1,1,0,0,\dots,1]$ã€‚æˆ–è€…ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨é¢‘ç‡ï¼š$[1,2,1,4,\dots,90,0,0]$ã€‚æˆ–è€…ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨ **TF-IDF** æ–¹å¼èµ‹äºˆæƒé‡ã€‚

### TF-IDF Weighting

ä¸€ä¸ªå•è¯ $t$ åœ¨æ–‡æ¡£ $d$ ä¸­çš„é‡è¦æ€§å¯ä»¥é€šè¿‡è¯é¢‘-é€†æ–‡æ¡£é¢‘ç‡è¿›è¡Œè¡¡é‡ã€‚å…·ä½“è€Œè¨€ï¼š

$$
TF_{t, d} = \begin{cases}1 + \log_{10} count(t, d) &\text{if } count(t, d) > 0 \\ 0 & \text{otherwise}\end{cases}
$$

$$
IDF_t = log_{10} \frac{N}{DF_t}
$$

ä»£è¡¨æ€»æ–‡ä»¶æ•°é™¤ä»¥åŒ…å«è¯¥è¯è¯­çš„æ–‡ä»¶æ•°ç›®ã€‚

$$
\text{TF-IDF} = TF_{t,d} \times IDF_t
$$

----

?> ä¾‹ï¼šæˆ‘ä»¬ç°åœ¨æœ‰ä¸‰ä¸ªæ–‡æ¡£æ„æˆçš„è¯­æ–™åº“ã€‚**æ–‡æ¡£1**: "The cat sat on the mat" **æ–‡æ¡£2**: "The dog sat on the log" **æ–‡æ¡£3**: "The cat and the dog are friends" ç°åœ¨è®¡ç®—æ–‡æ¡£1çš„ TF-IDF å‘é‡ã€‚

**ç¬¬ä¸€æ­¥ï¼šè®¡ç®—è¯é¢‘ï¼ˆTFï¼‰**

è¯é¢‘ï¼ˆTerm Frequency, TFï¼‰è¡¨ç¤ºä¸€ä¸ªè¯åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„é¢‘ç‡ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å¯¹æ•°åŒ–çš„å…¬å¼ï¼š

$$
TF_{t, d} = \begin{cases}1 + \log_{10} count(t, d) &\text{if } count(t, d) > 0 \\ 0 & \text{otherwise}\end{cases}
$$

ä»¥æ–‡æ¡£1 "The cat sat on the mat" ä¸ºä¾‹ï¼š

- åˆ†è¯ç»“æœï¼š["the", "cat", "sat", "on", "the", "mat"]
- è¯é¢‘ç»Ÿè®¡ï¼š
  - the: 2
  - cat: 1
  - sat: 1
  - on: 1
  - mat: 1

è®¡ç®— TFï¼š

- the: \(1 + \log_{10}(2) \approx 1 + 0.301 = 1.301\)
- cat: \(1 + \log_{10}(1) = 1 + 0 = 1\)
- sat: 1
- on: 1
- mat: 1

**ç¬¬äºŒæ­¥ï¼šè®¡ç®—é€†æ–‡æ¡£é¢‘ç‡ï¼ˆIDFï¼‰**

é€†æ–‡æ¡£é¢‘ç‡ï¼ˆInverse Document Frequency, IDFï¼‰è¡¡é‡ä¸€ä¸ªè¯çš„æ™®éé‡è¦æ€§ã€‚å…¬å¼ä¸ºï¼š

$$
IDF_t = \log_{10} \left( \frac{N}{DF_t} \right)
$$

å…¶ä¸­ï¼š
- \(N\) æ˜¯æ–‡æ¡£æ€»æ•°ï¼ˆè¿™é‡Œæ˜¯3ï¼‰
- \(DF_t\) æ˜¯åŒ…å«è¯ \(t\) çš„æ–‡æ¡£æ•°é‡

é¦–å…ˆç»Ÿè®¡æ¯ä¸ªè¯çš„ DFï¼š

- the: å‡ºç°åœ¨æ‰€æœ‰3ä¸ªæ–‡æ¡£ â†’ DF=3
- cat: å‡ºç°åœ¨æ–‡æ¡£1å’Œæ–‡æ¡£3 â†’ DF=2
- sat: å‡ºç°åœ¨æ–‡æ¡£1å’Œæ–‡æ¡£2 â†’ DF=2
- on: å‡ºç°åœ¨æ–‡æ¡£1å’Œæ–‡æ¡£2 â†’ DF=2
- mat: åªåœ¨æ–‡æ¡£1å‡ºç° â†’ DF=1

è®¡ç®— IDFï¼š

- the: \(\log_{10}(3/3) = \log_{10}(1) = 0\)
- cat: \(\log_{10}(3/2) \approx \log_{10}(1.5) \approx 0.176\)
- sat: \(\log_{10}(3/2) \approx 0.176\)
- on: \(\log_{10}(3/2) \approx 0.176\)
- mat: \(\log_{10}(3/1) \approx \log_{10}(3) \approx 0.477\)

**ç¬¬ä¸‰æ­¥ï¼šè®¡ç®— TF-IDF**

TF-IDF æ˜¯ TF å’Œ IDF çš„ä¹˜ç§¯ï¼š

$$
\text{TF-IDF}_{t,d} = TF_{t,d} \times IDF_t
$$

ä»¥æ–‡æ¡£1ä¸­çš„ "cat" ä¸ºä¾‹ï¼š

- TF("cat", æ–‡æ¡£1) = 1
- IDF("cat") â‰ˆ 0.176
- TF-IDF = \(1 \times 0.176 = 0.176\)

å†ä»¥æ–‡æ¡£1ä¸­çš„ "mat" ä¸ºä¾‹ï¼š

- TF("mat", æ–‡æ¡£1) = 1
- IDF("mat") â‰ˆ 0.477
- TF-IDF = \(1 \times 0.477 = 0.477\)

**å®Œæ•´ç¤ºä¾‹ï¼šæ–‡æ¡£1çš„ TF-IDF å‘é‡**

æ–‡æ¡£1 "The cat sat on the mat" çš„è¯å’Œ TF-IDF å€¼ï¼š

- the: \(1.301 \times 0 = 0\) ï¼ˆ"the" åœ¨æ‰€æœ‰æ–‡æ¡£ä¸­å‡ºç°ï¼ŒIDF=0ï¼Œå› æ­¤ TF-IDF=0ï¼‰
- cat: \(1 \times 0.176 = 0.176\)
- sat: \(1 \times 0.176 = 0.176\)
- on: \(1 \times 0.176 = 0.176\)
- mat: \(1 \times 0.477 = 0.477\)

å…¶ä»–è¯çš„ TF-IDF ä¸º 0ï¼ˆå› ä¸ºæœªå‡ºç°åœ¨æ–‡æ¡£1ä¸­ï¼‰ã€‚

-----

### Bag Of Words è¯è¢‹æ¨¡å‹
é€šè¿‡ä¸Šè¿°çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ç§ç®€å•çš„ç‰¹å¾ï¼šç»Ÿè®¡æ–‡æ¡£æ¯ä¸ªè¯å‡ºç°çš„é¢‘ç‡ã€‚ç”¨ç‹¬çƒ­å‘é‡ã€é¢‘ç‡æˆ– TF-IDF å€¼éƒ½å¯ä»¥ã€‚æˆ‘ä»¬æŠŠå®ƒç§°ä¸ºè¯è¢‹æ¨¡å‹ã€‚

è€Œå¯¹äºæœ‰äº›å•è¯ï¼Œä¾‹å¦‚ a/an/the ç­‰ç»å¸¸å‡ºç°çš„è¯æ±‡ï¼Œå®ƒå¯¹ä»»åŠ¡çš„è´¡çŒ®å¹¶ä¸å¤§ã€‚æˆ‘ä»¬å¼•å…¥åœç”¨è¯è¡¨ (the stop-word list)ï¼Œå°†å®ƒä»¬è¿›è¡Œå¿½ç•¥ã€‚

?> ä¸Šé¢è¯´çš„ç‰¹å¾åˆ†æ˜æ˜¯ä¸€ä¸ªäºŒå…ƒå‡½æ•° $f(x,y)$ å•Šï¼Œä¸ºä»€ä¹ˆè¿™é‡Œæ²¡æœ‰ $y$ äº†å‘¢ï¼Ÿä¸€ç§è§£é‡Šï¼šè¯è¢‹æ¨¡å‹ä¹Ÿæ˜¯ä¸€ç§ç‰¹å¾ï¼Œè¿™æ ·çš„ç‰¹å¾åŸºäºæ–‡æœ¬çš„æœ¬èº«ï¼Œä»…ä¾èµ–è¾“å…¥ï¼Œæ˜¯ç‰¹å¾çš„ä¸€ç§ç®€å•å½¢å¼ã€‚

-----

## Feature Based Discriminative Models
æˆ‘ä»¬é¦–å…ˆå°è¯•ä¸€ä¸ªçº¿æ€§çš„åˆ†ç±»å™¨ï¼š$\lambda_{f(x, y)} f(x, y)$ï¼Œå…¶ä¸­ $\lambda$ æ˜¯æƒé‡ã€‚æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªä» $f(x, y)$ åˆ° $y$ çš„çº¿æ€§æ˜ å°„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è®¡ç®—ç±»åˆ«å‘¢ï¼Ÿåªéœ€è¦å…ˆç®—æ¯ä¸ª instance $x$ çš„ scoreï¼š$$score(x,y) = \sum_i \lambda_{f_i(x, y)} f_i(x, y)$$ è¿™æ ·çš„è¯ï¼Œåˆ†ç±»å™¨ä¼šå–ä½¿å¾— score æœ€å¤§çš„ $y$ ä½œä¸º $y^*$ã€‚

é‚£ä¹ˆï¼Œè¿™äº› $\lambda$ è¯¥å¦‚ä½•ç¡®å®šå‘¢ï¼Ÿæˆ‘ä»¬çš„å…³é”®æ˜¯ï¼Œå¯¹äºä¸åŒçš„ç‰¹å¾ï¼Œç¡®å®šå¥½ç‰¹å®šçš„ $\lambda$ã€‚å¸¸è§çš„æ–¹æ³•æœ‰ï¼š
- æ„ŸçŸ¥æœºç®—æ³•
- åŸºäº Margin çš„æ¨¡å‹ ï¼ˆå¦‚SVMï¼‰
- æŒ‡æ•°é›†çš„æ¨¡å‹

è¿™é‡Œï¼Œæˆ‘ä»¬é‡ç‚¹è®²è§£ Log-Linear Modelsã€‚

### Log-Linear Models
å¯¹äºä¸€å¯¹æ•°æ® $(x, y)$ï¼Œæˆ‘ä»¬åœ¨æ„çš„æ˜¯ï¼š$$p(y \mid x) = \frac{\exp \sum_i \lambda_{f_i(x, y)} f_i(x, y)}{\sum_{y'}exp\sum_i \lambda_{f_i(x, y')} f_i(x, y')} = \frac{\exp (\bm \lambda \cdot \bm f(x, y))}{\sum_{y'}\exp (\bm \lambda \cdot \bm f(x, y'))}$$

`å…¶å®æ— éå°±æ˜¯ä¸€ä¸ª softmax è€Œå·²ã€‚`

é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ç¡®å®šé‡Œé¢çš„ $\bm \lambda$ å‘¢ï¼Ÿè¿™æ—¶æå¤§ä¼¼ç„¶ä¼°è®¡å°±å¯ä»¥æ´¾ä¸Šç”¨åœºäº†ã€‚

**æ„å»ºä¼¼ç„¶å‡½æ•°**

é¦–å…ˆæ„å»ºä¼¼ç„¶å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è®­ç»ƒæ•°æ®å‘ç”Ÿçš„æ¦‚ç‡ã€‚$$L(\bm \lambda) = \prod_k p(y_k \mid x_k; \bm \lambda) = \prod_k \frac{\exp (\bm \lambda \cdot \bm f(x_k, y_k))}{\sum_{y'}\exp (\bm \lambda \cdot \bm f(x_k, y'))}$$

**æ±‚å¯¹æ•°ä¼¼ç„¶**

$$LL(\bm \lambda) = \sum_k \log p(y_k \mid x_k; \bm \lambda) = \sum_k \bm \lambda \cdot \bm f(x_k, y_k) - \sum_k \log \sum_{y'} \exp(\bm \lambda \cdot \bm f(x_k, y'))$$

æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼Œæœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶å‡½æ•°ã€‚

**æ±‚å¯¼å¹¶è®©å¯¼æ•°ä¸º0**

$$\frac{\partial LL(\bm \lambda)}{\partial \lambda_{f_i(,)}} = \sum_k f_i (x_k, y_k) - \sum_k \sum_{y'}f_i(x_k, y')p(y' \mid x_k; \bm \lambda)$$

ç¬¬ä¸€é¡¹ï¼šEmpirical Countsï¼Œç¬¬äºŒé¡¹ï¼šExpected Countsã€‚å¦‚æœå¯¹æ•°ä¼¼ç„¶å‡½æ•°æœ€å¤§ï¼Œé‚£ä¹ˆå¯¼æ•°åº”è¯¥å°½å¯èƒ½ä¸º0ã€‚ä¹Ÿå°±æ˜¯è®© Empirical Counts å°½å¯èƒ½å» match Expected Countsã€‚
